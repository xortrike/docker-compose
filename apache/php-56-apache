FROM php:5.6-apache

# Configure time zone
RUN ln -snf /usr/share/zoneinfo/$TIME_ZONA /etc/localtime && echo $TIME_ZONA > /etc/timezone

# Update and Install default packages
RUN apt-get update && \
    apt-get install -y sudo nano wget zlib1g-dev cron git

# Zip
RUN apt-get install -y libzip-dev unzip && \
    docker-php-ext-install zip

# Composer
RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/bin/ --filename=composer

# MySQL
RUN docker-php-ext-install mysqli pdo pdo_mysql && \
    docker-php-ext-configure pdo_mysql --with-pdo-mysql=mysqlnd && \
    docker-php-ext-configure mysqli --with-mysqli=mysqlnd

# Modules
RUN docker-php-ext-install bcmath sockets
# soap
RUN apt-get install -y libxml2-dev && \
    docker-php-ext-install soap
#intl
RUN apt-get install -y libicu-dev g++ && \
    docker-php-ext-configure intl && \
    docker-php-ext-install intl
# xsl
RUN apt-get install -y libxslt-dev && \
    docker-php-ext-install xsl
# mcrypt
RUN apt-get install -y libmcrypt-dev && \
    docker-php-ext-install mcrypt

# GD image
RUN apt-get install -y \
    libwebp-dev \
    libjpeg62-turbo-dev \
    libpng-dev \
    libxpm-dev \
    libfreetype6-dev
RUN docker-php-ext-configure gd \
    --with-gd \
    --with-webp-dir \
    --with-jpeg-dir \
    --with-png-dir \
    --with-zlib-dir \
    --with-xpm-dir \
    --with-freetype-dir \
    --enable-gd-native-ttf
RUN docker-php-ext-install gd

RUN a2enmod rewrite ssl

# X-Debug - version log https://xdebug.org/download
RUN pecl install xdebug-2.5.5 && \
   docker-php-ext-enable xdebug

# Install mSMTP
RUN apt-get install -y msmtp
COPY msmtprc /etc/msmtprc
RUN chmod 600 /etc/msmtprc

# Clean up APT when done.
RUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*

# Connect as www-data
# USER www-data
